<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ˜æ˜ŸçŒœæ‹³éŠæˆ²</title>
    <style>
        /* è¼‰å…¥ç•«é¢æ¨£å¼ */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        .loading-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        .loading-text {
            color: #fff;
            font-size: 48px;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #ff0000;
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        .loading-text.game-title {
            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);
            background-size: 400%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: rainbow 8s linear infinite;
            text-shadow: none;
            font-size: 56px;
            margin-bottom: 30px;
        }
        .loading-bar {
            width: 300px;
            height: 20px;
            background-color: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .loading-progress {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            transition: width 0.3s ease-out;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 10px #ff0000;
            }
            to {
                text-shadow: 0 0 20px #ff0000, 0 0 30px #ff0000;
            }
        }
        @keyframes rainbow {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        /* åŸæœ‰æ¨£å¼ */
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            position: relative;
            overflow-x: hidden;
        }
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
            z-index: 1;
        }
        .boss-container {
            margin: 20px 0;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .boss-name {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
            transition: all 0.5s;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.1);
            display: inline-block;
            animation: nameFloat 3s ease-in-out infinite;
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
        }
        .boss-name.level-1 { 
            color: #2c3e50;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #ecf0f1, #ffffff);
        }
        .boss-name.level-2 { 
            color: #3498db;
            text-shadow: 0 0 10px #3498db;
            background: linear-gradient(45deg, #e8f4fc, #ffffff);
        }
        .boss-name.level-3 { 
            color: #e74c3c;
            text-shadow: 0 0 15px #e74c3c;
            background: linear-gradient(45deg, #fdedec, #ffffff);
        }
        .boss-name.level-4 { 
            color: #9b59b6;
            text-shadow: 0 0 20px #9b59b6;
            background: linear-gradient(45deg, #f5eef8, #ffffff);
            animation: namePulse 2s ease-in-out infinite;
        }
        .boss-name.level-5 { 
            color: #e67e22;
            text-shadow: 0 0 25px #e67e22;
            background: linear-gradient(45deg, #fef5e7, #ffffff);
            animation: namePulse 1.5s ease-in-out infinite;
        }
        .boss-name.level-6 {
            color: #1abc9c;
            text-shadow: 0 0 20px #1abc9c;
            background: linear-gradient(45deg, #e8f8f5, #ffffff);
            animation: nameGlow 2s ease-in-out infinite;
        }
        .boss-name.level-7 {
            color: #34495e;
            text-shadow: 0 0 20px #34495e;
            background: linear-gradient(45deg, #ebedef, #ffffff);
            animation: nameGlow 1.8s ease-in-out infinite;
        }
        .boss-name.level-8 {
            color: #f1c40f;
            text-shadow: 0 0 20px #f1c40f;
            background: linear-gradient(45deg, #fef9e7, #ffffff);
            animation: nameGlow 1.6s ease-in-out infinite;
        }
        .boss-name.level-9 {
            color: #d35400;
            text-shadow: 0 0 25px #d35400;
            background: linear-gradient(45deg, #fef2e7, #ffffff);
            animation: nameGlow 1.4s ease-in-out infinite;
        }
        .boss-name.level-10 {
            color: #c0392b;
            text-shadow: 0 0 30px #c0392b;
            background: linear-gradient(45deg, #fdedec, #ffffff);
            animation: nameGlow 1s ease-in-out infinite;
        }
        .boss-name.level-10-plus {
            color: #ff0000;
            text-shadow: 
                0 0 10px #ff0000,
                0 0 20px #ff0000,
                0 0 30px #ff0000,
                0 0 40px #ff0000;
            background: linear-gradient(45deg, #ffcccc, #ffffff);
            animation: nameGlow 1s ease-in-out infinite;
            font-weight: 900;
            letter-spacing: 2px;
        }
        .boss-image {
            width: 250px;
            height: 250px;
            object-fit: cover;
            border-radius: 15px;
            margin: 20px 0;
            transition: transform 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .boss-image.defeated {
            animation: defeat 1s ease-out forwards;
        }
        .boss-image.appear {
            animation: appear 1s ease-out;
        }
        @keyframes defeat {
            0% {
                transform: translateX(0) rotate(0);
                opacity: 1;
            }
            100% {
                transform: translateX(100vw) rotate(360deg);
                opacity: 0;
            }
        }
        @keyframes appear {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            100% {
                transform: scale(1) rotate(0);
                opacity: 1;
            }
        }
        .lives {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        .life-heart {
            font-size: 30px;
        }
        .choices {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
        }
        .choice {
            font-size: 45px;
            cursor: pointer;
            transition: all 0.3s;
            padding: 12px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .choice:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        .result {
            font-size: 28px;
            margin: 20px 0;
            font-weight: bold;
            color: #2c3e50;
        }
        .level {
            font-size: 24px;
            margin: 15px 0;
            color: #34495e;
            font-weight: bold;
        }

        /* æ’è¡Œæ¦œæ¨£å¼ */
        .leaderboard {
            position: fixed;
            right: 20px;
            top: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            min-width: 200px;
        }
        .leaderboard h3 {
            margin: 0 0 10px 0;
            color: #ffd700;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .clear-leaderboard {
            font-size: 16px;
            cursor: pointer;
            color: #ff6b6b;
            transition: all 0.3s;
        }
        .clear-leaderboard:hover {
            color: #ff0000;
            transform: scale(1.1);
        }
        .leaderboard ol {
            margin: 0;
            padding-left: 20px;
        }
        .leaderboard li {
            margin: 5px 0;
            color: #fff;
        }
        .game-over-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            color: white;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            animation: modalAppear 0.5s ease-out;
            border: 2px solid #ff0000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .game-over-modal h2 {
            color: #ff0000;
            margin-bottom: 20px;
            font-size: 36px;
            text-shadow: 0 0 10px #ff0000;
            animation: textGlow 1.5s ease-in-out infinite;
        }
        .game-over-modal p {
            font-size: 24px;
            margin: 20px 0;
            color: #fff;
        }
        .game-over-modal .final-level {
            color: #ffd700;
            font-size: 48px;
            font-weight: bold;
            text-shadow: 0 0 15px #ffd700;
            animation: levelPulse 2s ease-in-out infinite;
        }
        .game-over-modal button {
            padding: 15px 30px;
            margin: 20px 10px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            color: white;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
        }
        .game-over-modal button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(255, 0, 0, 0.5);
        }
        .game-over-modal .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff0000;
            animation: confettiFall 3s ease-in-out infinite;
        }

        @keyframes modalAppear {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 0 0 10px #ff0000;
            }
            50% {
                text-shadow: 0 0 20px #ff0000, 0 0 30px #ff0000;
            }
        }

        @keyframes levelPulse {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 0 15px #ffd700;
            }
            50% {
                transform: scale(1.1);
                text-shadow: 0 0 25px #ffd700, 0 0 35px #ffd700;
            }
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100%) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes nameFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes namePulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes nameGlow {
            0%, 100% {
                text-shadow: 
                    0 0 10px #ff0000,
                    0 0 20px #ff0000,
                    0 0 30px #ff0000,
                    0 0 40px #ff0000;
            }
            50% {
                text-shadow: 
                    0 0 20px #ff0000,
                    0 0 30px #ff0000,
                    0 0 40px #ff0000,
                    0 0 50px #ff0000,
                    0 0 60px #ff0000;
            }
        }

        .sound-control {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            z-index: 1000;
        }
        .sound-control:hover {
            transform: scale(1.1);
        }
        .sound-control i {
            font-size: 24px;
            color: #2c3e50;
        }

        .inventory {
            position: fixed;
            left: 20px;
            top: 80px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .inventory-toggle {
            font-size: 30px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .inventory-toggle:hover {
            transform: scale(1.1);
        }
        .inventory-title {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
            font-weight: bold;
        }
        .inventory-items {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .inventory-items.show {
            display: block;
        }
        .item {
            font-size: 24px;
            margin: 5px 0;
            padding: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
        }
        .item:hover {
            background: rgba(0,0,0,0.1);
            transform: scale(1.05);
        }
        .item-description {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        .item-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: itemPopup 1s ease-out forwards;
            text-align: center;
        }
        .item-notification .item-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        .item-notification .item-name {
            font-size: 24px;
            color: #2c3e50;
            font-weight: bold;
        }
        @keyframes itemPopup {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }
        .item-tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 2000;
            pointer-events: none;
            display: none;
        }
        .item-tooltip.show {
            display: block;
        }
        .start-game-btn {
            display: none;
            padding: 20px 40px;
            font-size: 24px;
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
        }

        .start-game-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(255, 0, 0, 0.5);
        }

        /* æ·»åŠ å‹•æ…‹èƒŒæ™¯ç²’å­æ•ˆæœ */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100vh) translateX(100vw);
                opacity: 0;
            }
        }

        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <!-- é“å…·æ¬„ -->
    <div class="inventory">
        <div class="inventory-toggle" onclick="toggleInventory()">ğŸ’</div>
        <div class="inventory-title">é“å…·æ¬„</div>
        <div class="inventory-items" id="inventoryItems">
            <!-- é“å…·å°‡ç”± JavaScript å‹•æ…‹æ·»åŠ  -->
        </div>
    </div>

    <!-- é“å…·æç¤ºæ¡† -->
    <div class="item-tooltip" id="itemTooltip"></div>

    <!-- éŸ³æ•ˆæ§åˆ¶æŒ‰éˆ• -->
    <div class="sound-control" onclick="toggleSound()">
        <i class="fas fa-volume-up" id="soundIcon"></i>
    </div>

    <!-- èƒŒæ™¯éŸ³æ¨‚ -->
    <audio id="bgMusic" loop preload="auto">
        <source src="https://drive.google.com/uc?export=download&id=1TmEIIKolG2d-eCqms0hW-cPaR4mymbS8" type="audio/mpeg">
    </audio>

    <!-- éŸ³æ•ˆ -->
    <audio id="winSound" preload="auto">
        <source src="https://drive.google.com/uc?export=download&id=1TmEIIKolG2d-eCqms0hW-cPaR4mymbS8" type="audio/mpeg">
    </audio>
    <audio id="loseSound" preload="auto">
        <source src="https://drive.google.com/uc?export=download&id=1TmEIIKolG2d-eCqms0hW-cPaR4mymbS8" type="audio/mpeg">
    </audio>
    <audio id="drawSound" preload="auto">
        <source src="https://drive.google.com/uc?export=download&id=1TmEIIKolG2d-eCqms0hW-cPaR4mymbS8" type="audio/mpeg">
    </audio>

    <!-- è¼‰å…¥ç•«é¢ -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-text game-title">å…¨æ˜æ˜ŸçŒœæ‹³éŠæˆ²</div>
        <div class="loading-text">LOADING</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
        <button class="start-game-btn" id="startGameBtn">é–‹å§‹éŠæˆ²</button>
    </div>

    <div class="game-container">
        <h1>å…¨æ˜æ˜ŸçŒœæ‹³éŠæˆ²</h1>
        <div class="level">é—œå¡: <span id="level">1</span></div>
        
        <div class="boss-container">
            <h2>Boss</h2>
            <div id="boss-name" class="boss-name level-1">çŒ´å“¥ä½é…ç‰ˆ</div>
            <img id="boss-image" class="boss-image" src="çŒ´å“¥ä½é…ç‰ˆ.jpg" alt="Boss">
            <div class="lives" id="boss-lives">
                <span class="life-heart">â¤ï¸</span>
                <span class="life-heart">â¤ï¸</span>
                <span class="life-heart">â¤ï¸</span>
            </div>
        </div>

        <div class="player-container">
            <h2>ç©å®¶</h2>
            <div class="lives" id="player-lives">
                <span class="life-heart">â¤ï¸</span>
                <span class="life-heart">â¤ï¸</span>
                <span class="life-heart">â¤ï¸</span>
            </div>
        </div>

        <div class="choices">
            <span class="choice" onclick="play('scissors')">âœ‚ï¸</span>
            <span class="choice" onclick="play('rock')">âœŠ</span>
            <span class="choice" onclick="play('paper')">âœ‹</span>
        </div>

        <div class="result" id="result"></div>
    </div>

    <!-- éŠæˆ²çµæŸå½ˆçª— -->
    <div id="gameOverModal" class="game-over-modal">
        <h2>éŠæˆ²çµæŸï¼</h2>
        <p>ä½ ç©åˆ°äº†ç¬¬ <span id="finalLevel" class="final-level">1</span> é—œ çˆ›æ­»äº†</p>
        <button onclick="restartGame()">é‡æ–°é–‹å§‹</button>
    </div>

    <!-- æ·»åŠ å‹•æ…‹èƒŒæ™¯ç²’å­æ•ˆæœ -->
    <div class="particles">
        <!-- ç²’å­å°‡ç”± JavaScript å‹•æ…‹æ·»åŠ  -->
    </div>

    <script>
        // éŸ³æ•ˆæ§åˆ¶
        let isMuted = false;
        const bgMusic = document.getElementById('bgMusic');
        const winSound = document.getElementById('winSound');
        const loseSound = document.getElementById('loseSound');
        const drawSound = document.getElementById('drawSound');
        const soundIcon = document.getElementById('soundIcon');

        function toggleSound() {
            isMuted = !isMuted;
            bgMusic.muted = isMuted;
            winSound.muted = isMuted;
            loseSound.muted = isMuted;
            drawSound.muted = isMuted;
            soundIcon.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
        }

        // è¼‰å…¥ç•«é¢é‚è¼¯
        window.addEventListener('load', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingProgress = document.getElementById('loadingProgress');
            const startGameBtn = document.getElementById('startGameBtn');
            const gameOverModal = document.getElementById('gameOverModal');
            let progress = 0;

            // ç¢ºä¿éŠæˆ²çµæŸç•«é¢ä¸€é–‹å§‹æ˜¯éš±è—çš„
            gameOverModal.style.display = 'none';

            // æ¨¡æ“¬è¼‰å…¥é€²åº¦
            const loadingInterval = setInterval(() => {
                progress += 5;
                loadingProgress.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    setTimeout(() => {
                        startGameBtn.style.display = 'block';
                    }, 500);
                }
            }, 100);

            // é–‹å§‹éŠæˆ²æŒ‰éˆ•é»æ“Šäº‹ä»¶
            startGameBtn.addEventListener('click', function() {
                loadingScreen.classList.add('fade-out');
                bgMusic.play();
                // åˆå§‹åŒ–éŠæˆ²ç‹€æ…‹
                playerLives = 3;
                bossLives = 3;
                level = 1;
                document.getElementById('level').textContent = level;
                updateLives();
                updateBossLevel();
                // ç¢ºä¿éŠæˆ²çµæŸç•«é¢æ˜¯éš±è—çš„
                gameOverModal.style.display = 'none';
            });
        });

        let playerLives = 3;
        let bossLives = 3;
        let level = 1;
        const bossImages = [
            'çŒ´å“¥ä½é…ç‰ˆ.jpg',
            'è£ç”²è»Šno.114514.jpg',
            'å”å”æˆ°è»Š.jpg',
            'boss4.jpg',
            'boss5.jpg',
            'boss6.jpg',
            'boss7.jpg',
            'boss8.jpg',
            'boss9.jpg',
            'boss10.jpg'
        ];
        const bossNames = [
            'çŒ´å“¥ä½é…ç‰ˆ',
            'è£ç”²è»Šno.114514',
            'å”å”æˆ°è»Š',
            'é‹¼éµä¿ ',
            'èœ˜è››äºº',
            'é›·ç¥ç´¢çˆ¾',
            'é»‘å¯¡å©¦',
            'å¥‡ç•°åšå£«',
            'é©šå¥‡éšŠé•·',
            'çµ‚æ¥µ Boss'
        ];

        function updateLives() {
            const playerLivesContainer = document.getElementById('player-lives');
            const bossLivesContainer = document.getElementById('boss-lives');
            
            playerLivesContainer.innerHTML = '';
            bossLivesContainer.innerHTML = '';
            
            for (let i = 0; i < playerLives; i++) {
                playerLivesContainer.innerHTML += '<span class="life-heart">â¤ï¸</span>';
            }
            
            for (let i = 0; i < bossLives; i++) {
                bossLivesContainer.innerHTML += '<span class="life-heart">â¤ï¸</span>';
            }
        }

        function getBossChoice() {
            const choices = ['rock', 'paper', 'scissors'];
            return choices[Math.floor(Math.random() * 3)];
        }

        function determineWinner(playerChoice, bossChoice) {
            if (playerChoice === bossChoice) return 'å¹³æ‰‹';
            
            if (
                (playerChoice === 'rock' && bossChoice === 'scissors') ||
                (playerChoice === 'paper' && bossChoice === 'rock') ||
                (playerChoice === 'scissors' && bossChoice === 'paper')
            ) {
                return 'ç©å®¶è´';
            }
            
            return 'Bossè´';
        }

        function updateBossLevel() {
            const bossName = document.getElementById('boss-name');
            const bossImage = document.getElementById('boss-image');
            
            // æ›´æ–° Boss åç¨±å’Œç­‰ç´šæ¨£å¼
            if (level <= 10) {
                bossName.textContent = bossNames[level - 1];
                bossName.className = 'boss-name level-' + level;
            } else {
                // ç¬¬åé—œä¹‹å¾Œéš¨æ©Ÿé¸æ“‡å‰ 10 é—œçš„åç¨±
                const randomIndex = Math.floor(Math.random() * 10);
                bossName.textContent = bossNames[randomIndex];
                bossName.className = 'boss-name level-10-plus';
            }
            
            // æ·»åŠ å‡ºç¾å‹•ç•«
            bossImage.classList.remove('appear');
            void bossImage.offsetWidth; // è§¸ç™¼é‡ç¹ª
            bossImage.classList.add('appear');
        }

        // é“å…·ç³»çµ±
        const items = {
            'ğŸ’–': { name: 'ç”Ÿå‘½è—¥æ°´', description: 'æ¢å¾©ä¸€é»ç”Ÿå‘½å€¼', effect: 'ç«‹å³æ¢å¾©ä¸€é»ç”Ÿå‘½å€¼' },
            'âš¡': { name: 'é–ƒé›»', description: 'æœ‰50%æ©Ÿç‡ç›´æ¥æ“Šæ•—BOSS', effect: 'æœ‰50%æ©Ÿç‡ç›´æ¥æ“Šæ•—ç•¶å‰BOSS' },
            'ğŸ‘ï¸': { name: 'é€è¦–é¡', description: 'å¯ä»¥çœ‹åˆ°å°æ‰‹çš„é¸æ“‡', effect: 'é¡¯ç¤ºå°æ‰‹ä¸‹ä¸€æ¬¡çš„é¸æ“‡' },
            'ğŸŒ': { name: 'é¦™è•‰', description: 'æ‰£é™¤å°æ‰‹ä¸€é»ç”Ÿå‘½å€¼', effect: 'æ‰£é™¤å°æ‰‹ä¸€é»ç”Ÿå‘½å€¼ï¼Œä½†æœ‰æ©Ÿç‡è¢«æ””æˆª' }
        };

        let inventory = [];
        let isInventoryVisible = false;
        let tooltipTimeout;
        let longPressTimeout;

        function toggleInventory() {
            const inventoryItems = document.getElementById('inventoryItems');
            isInventoryVisible = !isInventoryVisible;
            inventoryItems.classList.toggle('show');
        }

        function showTooltip(event, item) {
            const tooltip = document.getElementById('itemTooltip');
            tooltip.textContent = items[item].effect;
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY + 10) + 'px';
            tooltip.classList.add('show');
        }

        function hideTooltip() {
            const tooltip = document.getElementById('itemTooltip');
            tooltip.classList.remove('show');
        }

        function showItemNotification(item) {
            const notification = document.createElement('div');
            notification.className = 'item-notification';
            notification.innerHTML = `
                <div class="item-icon">${item}</div>
                <div class="item-name">ç²å¾— ${items[item].name}ï¼</div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        function addRandomItem() {
            const itemKeys = Object.keys(items);
            const randomItem = itemKeys[Math.floor(Math.random() * itemKeys.length)];
            inventory.push(randomItem);
            updateInventory();
            showItemNotification(randomItem);
        }

        function updateInventory() {
            const inventoryItems = document.getElementById('inventoryItems');
            inventoryItems.innerHTML = '';
            
            inventory.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item';
                itemElement.innerHTML = `
                    ${item}
                    <div class="item-description">${items[item].name}</div>
                `;
                
                // æ·»åŠ é•·æŒ‰äº‹ä»¶
                itemElement.addEventListener('mousedown', (e) => {
                    longPressTimeout = setTimeout(() => {
                        showTooltip(e, item);
                    }, 500);
                });

                itemElement.addEventListener('mouseup', () => {
                    clearTimeout(longPressTimeout);
                    hideTooltip();
                });

                itemElement.addEventListener('mouseleave', () => {
                    clearTimeout(longPressTimeout);
                    hideTooltip();
                });

                itemElement.addEventListener('mousemove', (e) => {
                    if (document.getElementById('itemTooltip').classList.contains('show')) {
                        showTooltip(e, item);
                    }
                });

                itemElement.onclick = () => useItem(index);
                inventoryItems.appendChild(itemElement);
            });
        }

        function useItem(index) {
            const item = inventory[index];
            switch(item) {
                case 'ğŸ’–':
                    if (playerLives < 3) {
                        playerLives++;
                        updateLives();
                    }
                    break;
                case 'âš¡':
                    // 50% æ©Ÿç‡ç›´æ¥æ“Šæ•— BOSS
                    if (Math.random() < 0.5) {
                        bossLives = 0;
                        updateLives();
                        document.getElementById('result').textContent = 'é–ƒé›»æ“Šä¸­ï¼BOSS è¢«æ“Šæ•—äº†ï¼';
                        
                        setTimeout(() => {
                            level++;
                            bossLives = 3;
                            document.getElementById('level').textContent = level;
                            if (level <= bossImages.length) {
                                const bossImage = document.getElementById('boss-image');
                                bossImage.src = bossImages[level - 1];
                                bossImage.classList.remove('defeated');
                                updateBossLevel();
                                // ç«‹å³æ›´æ–° BOSS è¡€æ¢
                                const bossLivesContainer = document.getElementById('boss-lives');
                                bossLivesContainer.innerHTML = '<span class="life-heart">â¤ï¸</span><span class="life-heart">â¤ï¸</span><span class="life-heart">â¤ï¸</span>';
                            }
                            document.getElementById('result').textContent = 'æ­å–œï¼é€²å…¥ä¸‹ä¸€é—œï¼';
                            // æ¯éä¸€é—œçµ¦äºˆéš¨æ©Ÿé“å…·
                            addRandomItem();
                        }, 1000);
                    } else {
                        document.getElementById('result').textContent = 'é–ƒé›»æ²’æœ‰æ“Šä¸­ï¼';
                    }
                    break;
                case 'ğŸ‘ï¸':
                    const bossChoice = getBossChoice();
                    alert(`å°æ‰‹é¸æ“‡äº†: ${bossChoice === 'rock' ? 'âœŠ' : bossChoice === 'paper' ? 'âœ‹' : 'âœ‚ï¸'}`);
                    break;
                case 'ğŸŒ':
                    // 30% æ©Ÿç‡è¢«æ””æˆª
                    if (Math.random() < 0.3) {
                        playerLives--;
                        updateLives();
                        document.getElementById('result').textContent = 'é¦™è•‰è¢«çŒ´è±†æ””æˆªäº†ï¼';
                    } else {
                        if (bossLives > 0) {
                            bossLives--;
                            updateLives();
                            document.getElementById('result').textContent = 'é¦™è•‰æ”»æ“ŠæˆåŠŸï¼';
                        }
                    }
                    break;
            }
            inventory.splice(index, 1);
            updateInventory();
        }

        // ä¿®æ”¹ play å‡½æ•¸ä»¥æ”¯æ´éŸ³æ•ˆ
        function play(playerChoice) {
            const bossChoice = getBossChoice();
            let result = determineWinner(playerChoice, bossChoice);
            const currentBossName = document.getElementById('boss-name').textContent;
            
            // è™•ç†é“å…·æ•ˆæœ
            if (window.nextRoundWin) {
                result = 'ç©å®¶è´';
                window.nextRoundWin = false;
            } else if (window.nextRoundShield && result === 'Bossè´') {
                result = 'å¹³æ‰‹';
                window.nextRoundShield = false;
            }
            
            if (result === 'ç©å®¶è´') {
                bossLives--;
                document.getElementById('result').textContent = 'å–”è¶…æ‰¯è¶…æ‰¯';
                if (!isMuted) winSound.play();
            } else if (result === 'Bossè´') {
                playerLives--;
                document.getElementById('result').textContent = `çœŸçˆ› é€£${currentBossName}éƒ½æ‰“ä¸è´`;
                if (!isMuted) loseSound.play();
            } else {
                document.getElementById('result').textContent = `å“‡è€–! ä½ å’Œ${currentBossName}æ‰“æˆå¹³æ‰‹`;
                if (!isMuted) drawSound.play();
            }

            updateLives();

            if (bossLives === 0) {
                const bossImage = document.getElementById('boss-image');
                bossImage.classList.add('defeated');
                
                setTimeout(() => {
                    level++;
                    bossLives = 3;
                    document.getElementById('level').textContent = level;
                    if (level <= bossImages.length) {
                        bossImage.src = bossImages[level - 1];
                        bossImage.classList.remove('defeated');
                        updateBossLevel();
                        // ç«‹å³æ›´æ–° BOSS è¡€æ¢
                        const bossLivesContainer = document.getElementById('boss-lives');
                        bossLivesContainer.innerHTML = '<span class="life-heart">â¤ï¸</span><span class="life-heart">â¤ï¸</span><span class="life-heart">â¤ï¸</span>';
                    }
                    document.getElementById('result').textContent = 'æ­å–œï¼é€²å…¥ä¸‹ä¸€é—œï¼';
                    // æ¯éä¸€é—œçµ¦äºˆéš¨æ©Ÿé“å…·
                    addRandomItem();
                }, 1000);
            }

            if (playerLives === 0) {
                gameOver();
            }
        }

        // ä¿®æ”¹éŠæˆ²çµæŸè™•ç†
        function gameOver() {
            document.getElementById('finalLevel').textContent = level;
            const modal = document.getElementById('gameOverModal');
            modal.style.display = 'flex';  // æ”¹ç‚º flex ä»¥æ”¯æ´å…¨ç•«é¢é¡¯ç¤º
            
            // æ·»åŠ å½©å¸¶æ•ˆæœ
            for (let i = 0; i < 50; i++) {
                createConfetti(modal);
            }
            
            // æš«åœèƒŒæ™¯éŸ³æ¨‚
            bgMusic.pause();
        }

        function createConfetti(container) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.animationDelay = Math.random() * 3 + 's';
            confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
            container.appendChild(confetti);
            
            // å‹•ç•«çµæŸå¾Œç§»é™¤å½©å¸¶
            setTimeout(() => {
                confetti.remove();
            }, 3000);
        }

        function restartGame() {
            // é‡æ–°é–‹å§‹æ™‚æ’­æ”¾èƒŒæ™¯éŸ³æ¨‚
            bgMusic.currentTime = 0;
            bgMusic.play();
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            playerLives = 3;
            bossLives = 3;
            level = 1;
            document.getElementById('level').textContent = level;
            updateLives();
            updateBossLevel();
            // éš±è—éŠæˆ²çµæŸç•«é¢
            document.getElementById('gameOverModal').style.display = 'none';
        }

        // åˆå§‹åŒ–æ™‚æ›´æ–° BOSS ç­‰ç´š
        window.addEventListener('load', function() {
            updateBossLevel();
        });

        // å‰µå»ºå‹•æ…‹èƒŒæ™¯ç²’å­
        function createParticles() {
            const particlesContainer = document.querySelector('.particles');
            const particleCount = 50;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // éš¨æ©Ÿä½ç½®
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.top = Math.random() * 100 + 'vh';
                
                // éš¨æ©Ÿå¤§å°
                const size = Math.random() * 3 + 2;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                // éš¨æ©Ÿå‹•ç•«å»¶é²
                particle.style.animationDelay = Math.random() * 20 + 's';
                
                // éš¨æ©Ÿå‹•ç•«æŒçºŒæ™‚é–“
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                
                particlesContainer.appendChild(particle);
            }
        }

        // åœ¨é é¢è¼‰å…¥æ™‚å‰µå»ºç²’å­
        window.addEventListener('load', function() {
            createParticles();
        });
    </script>
</body>
</html>
